<section 
    id="contactame"
    class="max-w-screen flex flex-1 lg:justify-center justify-start flex-col bg-sunny py-12 border-lg"
    onclick=toggleFlipCard()
>
		<section class="lg:px-10 relative mt-6 py-2 self-center text-center">
			<h2 class="text-dark font-semibold sm:text-5xl text-3xl">CONTACT</h2>
			<h3 class="text-active font-regular sm:text-xl text-lg"> away from a message </h3>
		</section>
		<div class="flex flex-1 lg:flex-row flex-col w-full">

			<div class="lg:w-2/5 w-full">
                <div class="w-full flex flex-1 lg:justify-center justify-start flex-row bg-gray-100 p-8">
                    <section class=" w-full bg-active text-sunny p-4 sm:p-8 rounded-lg shadow-lg sm:text-lg text-sm">
                        <h3 class=" font-semibold mb-4 uppercase">Contact Information</h3>
                        <p class="">Email: mandros.angelof@pucp.edu.pe</p>
                        <p class="">Phone: +51 950 436 941</p>
                        <p class="">Address: Lima, PE</p>
                    </section>
                </div>
                <div class="w-full flex flex-1 lg:justify-center justify-start flex-row bg-gray-100 p-8 rounded-lg">
                    <div class="flex flex-col items-center sm:p-8 p-4">
                        <h3 class="text-lg font-semibold mb-4 uppercase">Follow me:</h3>
                        <div class="flex justify-center space-x-4">
                            <a href="https://github.com/Norbory" target="_blank">
                                <svg class="w-8 h-8 text-sunny hover:text-blue-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd"/>
                                </svg>
                            </a>
                            <a href="https://www.linkedin.com/in/angelo-fabrizio-mandros-ramos/" target="_blank">
                                <svg class="w-8 h-8 text-sunny hover:text-blue-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15">
                                    <path fill-rule="evenodd" d="M7.979 5v1.586a3.5 3.5 0 0 1 3.082-1.574C14.3 5.012 15 7.03 15 9.655V15h-3v-4.738c0-1.13-.229-2.584-1.995-2.584-1.713 0-2.005 1.23-2.005 2.5V15H5.009V5h2.97ZM3 2.487a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" clip-rule="evenodd"/>
                                    <path d="M3 5.012H0V15h3V5.012Z"/>
                                </svg>
                            </a>
                            <a href="https://www.instagram.com/norbory/" target="_blank">
                                <svg class="w-8 h-8 text-sunny hover:text-blue-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path fill-rule="evenodd" d="M12 0c3.309 0 3.713.013 5.012.072 1.298.06 2.238.266 3.162.566.924.301 1.715.702 2.487 1.475.772.772 1.174 1.563 1.475 2.487.3.924.506 1.864.566 3.162.059 1.3.072 1.704.072 5.012s-.013 3.713-.072 5.012c-.06 1.298-.266 2.238-.566 3.162-.301.924-.702 1.715-1.475 2.487-.772.772-1.563 1.174-2.487 1.475-.924.3-1.864.506-3.162.566-1.299.059-1.703.072-5.012.072s-3.713-.013-5.012-.072c-1.298-.06-2.238-.266-3.162-.566-.924-.301-1.715-.702-2.487-1.475-.772-.772-1.174-1.563-1.475-2.487-.3-.924-.506-1.864-.566-3.162-.059-1.299-.072-1.703-.072-5.012s.013-3.713.072-5.012c.06-1.298.266-2.238.566-3.162.301-.924.702-1.715 1.475-2.487.772-.772 1.563-1.174 2.487-1.475.924-.3 1.864-.506 3.162-.566 1.299-.059 1.703-.072 5.012-.072Zm0 4.803c-2.982 0-5.397 2.415-5.397 5.397 0 2.982 2.415 5.397 5.397 5.397 2.982 0 5.397-2.415 5.397-5.397 0-2.982-2.415-5.397-5.397-5.397Zm0 9.204c-1.55 0-2.807-1.257-2.807-2.807s1.257-2.807 2.807-2.807 2.807 1.257 2.807 2.807-1.257 2.807-2.807 2.807Zm6.305-9.938c0-.782-.633-1.415-1.415-1.415-.782 0-1.415.633-1.415 1.415 0 .782.633 1.415 1.415 1.415.782 0 1.415-.633 1.415-1.415Z" clip-rule="evenodd"/>
                                </svg>
                            </a>                            
                        </div>
                    </div>
                </div>
            </div>
            
			<section class="fade-in flex flex-1 px-12 py-4 text-dark text-bold flex-col lg:w-3/5 w-full">
                <form id="contact-form" class="flex flex-col space-y-4">
                    <label class="text-lg" for="name">Name:</label>
                    <input 
                        class="border border-gray-300 px-3 py-2 rounded-lg focus:outline-none focus:border-blue-500" 
                        type="text" 
                        id="name" 
                        name="name" 
                        placeholder="Enter your name" 
                        required
                    >
                    <label class="text-lg" for="email">Email:</label>
                    <input 
                        class="border border-gray-300 px-3 py-2 rounded-lg focus:outline-none focus:border-blue-500" 
                        type="email" 
                        id="email" 
                        name="email" 
                        placeholder="Enter your email" 
                        required
                    >
                    <label class="text-lg" for="message">Message:</label>
                    <textarea 
                        class="border border-gray-300 px-3 py-2 rounded-lg focus:outline-none focus:border-blue-500" 
                        id="message" 
                        name="message" 
                        rows="4" 
                        placeholder="Enter your message" 
                        required
                    >
                    </textarea>
                    <button type="submit" class="self-center max-w-32 bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-contrast transition-all duration-200 ease-in-out transform hover:scale-105 hover:shadow-lg focus:outline-none">
                      Submit
                    </button>
                    <div id="status-message"></div>
                </form>                
            </section>
<style>
    #status-message {
        display: inline-block;
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: bold;
        transition: opacity 0.3s ease-in-out;
    }

    .error {
        background-color: #ffcccc;
        color: red;
    }

    .success {
        background-color: #ccffcc;
        color: green;
    }
</style>

<script>
    const form = document.getElementById('contact-form');
    const statusMessage = document.getElementById('status-message');

    function toggleFlipCard(){
        let carta = document.getElementById("contactame");
        if (carta) {
            carta.classList.toggle("flip-card");
        }
    }

    form?.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form as HTMLFormElement);
        const formDataObj = {} as any;

        for (const [key, value] of formData.entries()) {
            formDataObj[key]  = value;
        }

        const formDataJSON = JSON.stringify(formDataObj);

        try {
            const response = await fetch('https://mailserver-dev-sckq.1.us-1.fl0.io/send-email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json' // Configurar el encabezado Content-Type
            },
            body: formDataJSON // Enviar el formData como JSON
        });

            const data = await response.json();

            if (response.ok) {
                if (statusMessage) {
                    statusMessage.textContent = data.message;
                    statusMessage.classList.remove('error');
                    statusMessage.classList.add('success');
                    setTimeout(() => {
                        statusMessage.textContent = '';
                        (form as HTMLFormElement).reset();
                        form.setAttribute('disabled', 'true');
                    }, 3000);
                }
            } else {
                throw new Error(data.message);
            }
        } catch (error) {
            console.error(error);
            if (statusMessage) {
                statusMessage.textContent = 'Error al enviar el mensaje';
                statusMessage.classList.remove('success');
                statusMessage.classList.add('error');
                setTimeout(() => {
                    statusMessage.textContent = '';
                }, 3000);
            }
        }
    });
</script>
